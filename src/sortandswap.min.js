const $=document.querySelector.bind(document);const SortAndSwap=class{constructor(t){this.t=$("#"+t.containerId);this.i=t.i;this.type=t.o;this.storage=t.h;this.l=""}g(t){for(const e of container.children){if(e.contains(t.target))return e}}u(t){return $(`[data-sortindex='${t}']`)}S(){let i=[];[...this.t.children].forEach((t,e)=>{i[e]=[t.dataset.p]});return i.join(",")}$(){let t=this.S();localStorage.setItem(this.t.id,t)}L(){return localStorage.getItem(this.t.id)}m(t,e){let s=+e.dataset.p;let i=+t.dataset.p;let r=$(`[data-sortindex='${s}']`);let n=$(`[data-sortindex='${i}']`);let a=()=>{return[...container.children].findIndex(t=>t.dataset.p==s)};let o=()=>{return[...container.children].findIndex(t=>t.dataset.p==i)};const h=()=>{let t=container.children.item(s)==container.children.lastElementChild?null:a();let e=n.cloneNode(true);this.v(e);container.replaceChild(r,n);let i=t==null?null:container.children.item(t);container.insertBefore(e,i)};const l=()=>{if(a()<o()){n.after(r)}else{n.before(r)}};const c={sort:l,A:h};c[this.type]();this.$()}exchange(t){if(this.u(this.l)!=this.g(t)){this.g(t).classList.remove(this.i);this.m(this.g(t),this.u(this.l))}}v(e){e.addEventListener("dragover",t=>{t.preventDefault();this.g(t).classList.add(this.i)});e.addEventListener("dragstart",t=>{t.dataTransfer.setData("text/plain",this.g(t).dataset.p);e.classList.add(this.i);this.l=this.g(t).dataset.p});e.addEventListener("dragenter",t=>{t.preventDefault();if(this.type=="sort")this.exchange(t)});e.addEventListener("dragleave",t=>{this.g(t).classList.remove(this.i)});e.addEventListener("dragend",t=>{this.g(t).classList.remove(this.i)});e.addEventListener("drop",t=>{t.preventDefault();if(this.type=="swap")this.exchange(t)})}init(){[...container.children].forEach((t,e)=>{t.setAttribute("draggable",true);t.dataset.p=e;this.v(t)});if(this.storage){let t=localStorage.getItem(this.t.id);if(t==null){this.$()}else{let e=t.split(",");let i=[...this.t.children];let s=[];for(let t=0;t<i.length;t++){s.push(i[e[t]])}this.t.innerHTML="";s.forEach(t=>this.t.append(t))}}}};export default SortAndSwap;